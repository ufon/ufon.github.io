(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{273:function(e,t,n){e.exports=n(500)},500:function(e,t,n){"use strict";n.r(t);var a=n(1),r=n.n(a),o=n(11),l=n.n(o),i=n(524),c=n(526),u=n(508),s=n(525),p=n(523),d=n(27),m=n(267),h={write:function(e){return localStorage.setItem("jwt",e)},read:function(){return localStorage.getItem("jwt")},delete:function(){return localStorage.removeItem("jwt")}},f="".concat("https://poll-app-server.herokuapp.com","/api/graphql"),g=new m.a({uri:f,request:function(e){var t=h.read(),n={};t&&(n={authorization:"Bearer ".concat(t)}),e.setContext({headers:n})}}),v=n(153),b=function(e){var t=e.component,n=Object(v.a)(e,["component"]);return sessionStorage.setItem("auth:redirect",n.location.pathname),r.a.createElement(u.a,Object.assign({},n,{render:function(e){return h.read()?r.a.createElement(t,e):r.a.createElement(s.a,{to:{pathname:"/signin",state:{from:e.location}}})}}))},E=n(22),y=n(23),O=n(25),j=n(24),w=n(26),k=n(18),x=n(28),P=n.n(x),C=n(32),I=n.n(C),q=n(139),S=n(244),A=n(46),M=n(134),G=n(268),D=n(520),L=n(17),$=n(519),B=n(120),F=n(44);function T(){var e=Object(k.a)(["\n  position: absolute;\n  overflow: visible;\n  pointer-events: auto;\n  transform-origin: 50% 50% 0px;\n  border-radius: 4px;\n  color: rgb(153, 153, 153);\n  background-color: rgb(255, 255, 255);\n  box-sizing: border-box;\n  height: 80px;\n  display: flex;\n  align-items: center;\n  padding: 0 40px;\n"]);return T=function(){return e},e}function V(){var e=Object(k.a)(["\n  height: ",";\n  transition: height 300ms ease-in-out;\n"]);return V=function(){return e},e}var z=D.a.Group,Y=F.b.div(V(),function(e){return e.height?"".concat(e.height,"px"):"auto"}),H=F.b.div(T()),N=function(e,t,n){return Math.max(Math.min(e,n),t)};var U=function(e){function t(){var e,n;Object(E.a)(this,t);for(var a=arguments.length,r=new Array(a),o=0;o<a;o++)r[o]=arguments[o];return(n=Object(O.a)(this,(e=Object(j.a)(t)).call.apply(e,[this].concat(r)))).state={mouseY:0,topDeltaY:0,isPressed:!1,originalPosOfLastPressed:0},n.handleTouchStart=function(e,t,a){return n.handleMouseDown(e,t,a.touches[0])},n.handleTouchMove=function(e){return e.preventDefault()||n.handleMouseMove(e.touches[0])},n.handleMouseUp=function(){return n.setState({isPressed:!1,topDeltaY:0})},n.handleMouseDown=function(e,t,a){var r=a.pageY;return n.setState({topDeltaY:r-t,mouseY:t,isPressed:!0,originalPosOfLastPressed:e})},n.handleMouseMove=function(e){var t=e.pageY,a=n.state,r=a.isPressed,o=a.topDeltaY,l=a.originalPosOfLastPressed,i=n.props.order;if(r){var c=t-o,u=N(Math.round(c/100),0,i.length-1),s=i;u!==i.indexOf(l)&&(s=function(e,t,n){var a=e.slice(0),r=a[t];return a.splice(t,1),a.splice(n,0,r),a}(i,i.indexOf(l),u)),n.setState({mouseY:c}),n.props.onOrderChange(s)}},n}return Object(w.a)(t,e),Object(y.a)(t,[{key:"componentDidMount",value:function(){window.addEventListener("touchmove",this.handleTouchMove),window.addEventListener("touchend",this.handleMouseUp),window.addEventListener("mousemove",this.handleMouseMove),window.addEventListener("mouseup",this.handleMouseUp)}},{key:"render",value:function(){var e=this,t=this.state,n=t.mouseY,o=t.isPressed,l=t.originalPosOfLastPressed,i=this.props,c=i.options,u=i.order;return r.a.createElement(a.Fragment,null,u.length<5&&r.a.createElement(B.a,{onClick:function(){e.props.onAddOption()},type:"primary"},"Add option",r.a.createElement(L.a,{type:"plus"})),r.a.createElement(Y,{height:100*u.length},r.a.createElement(z,{onChange:this.props.onAnswerChange,value:this.props.answer},c.map(function(t){var a=l===t.id&&o,i=a?{scale:1.1,shadow:16,y:n}:{scale:1,shadow:1,y:100*u.indexOf(t.id)};return r.a.createElement(G.a,{immediate:function(e){return a&&"y"===e},to:i,key:t.id},function(n){var a=n.scale,o=n.shadow,i=n.y;return r.a.createElement(H,{onMouseDown:e.handleMouseDown.bind(null,t.id,i),onTouchStart:e.handleTouchStart.bind(null,t.id,i),style:{boxShadow:"rgba(0, 0, 0, 0.2) 0px ".concat(o,"px ").concat(2*o,"px 0px"),transform:"translate3d(0, ".concat(i,"px, 0) scale(").concat(a,")"),zIndex:t.id===l?99:t.id}},r.a.createElement(D.a,{value:t.id}),r.a.createElement($.a,{onChange:function(n){return e.props.onOptionValueChange(t.id,n.target.value)},value:t.value,placeholder:"Enter poll option here",size:"large"}),r.a.createElement(B.a,{type:"primary",style:{margin:"0 10px"},onClick:function(){e.props.onOptionDelete(t.id)},size:"small"},r.a.createElement(L.a,{type:"close"})))})}))))}}]),t}(r.a.Component),Q=n(521),K=function(e,t,n){Q.a[e]({message:t,description:n})},_=n(249),R=n.n(_),J=n(509),W=n(510),Z=function(e){function t(e){var n;return Object(E.a)(this,t),(n=Object(O.a)(this,Object(j.a)(t).call(this,e))).addOption=function(){var e="option_".concat(R()());n.setState({order:Object(M.a)(n.state.order).concat([e]),options:Object(M.a)(n.state.options).concat([{id:e,value:""}])})},n.deleteOption=function(e){return n.setState({order:n.state.order.filter(function(t){return t!==e}),options:n.state.options.filter(function(t){return t.id!==e})})},n.handleOrderChange=function(e){n.setState({order:e})},n.handleOptionValueChange=function(e,t){var a=n.state.options.findIndex(function(t){return t.id===e}),r=n.state.options;r[a].value=t,n.setState({options:r})},n.handleAnswerChange=function(e){n.setState({answer:e.target.value})},console.log(e),n.state={published:n.props.published||!1,order:n.props.order||[],answer:"",question:n.props.question||"",options:n.props.options||[]},n}return Object(w.a)(t,e),Object(y.a)(t,[{key:"render",value:function(){var e=this,t=this.state,n=t.options,o=t.answer,l=t.question,i=t.order,c=t.published,u=this.props,s=u.onSave,p=u.isUpdate,d=u.id;return r.a.createElement(a.Fragment,null,r.a.createElement($.a,{placeholder:"Poll question",onChange:function(t){e.setState({question:t.target.value})},value:l,style:{marginBottom:"20px"}}),r.a.createElement(J.a,{content:"Publish poll after creating?",trigger:"hover"},r.a.createElement(W.a,{defaultChecked:c,onChange:function(t){return e.setState({published:t})},style:{marginBottom:"20px"}})),r.a.createElement("p",null,"Please, choose the correct answer by radio button."),r.a.createElement(U,{options:n,order:i,answer:o,onOptionDelete:this.deleteOption,onOrderChange:this.handleOrderChange,onAnswerChange:this.handleAnswerChange,onAddOption:this.addOption,onOptionValueChange:this.handleOptionValueChange}),r.a.createElement(B.a,{onClick:Object(A.a)(I.a.mark(function e(){var t,a;return I.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,s({variables:Object(q.a)({},p?"updatePollInput":"createPollInput",Object(S.a)({},p&&{id:d},{question:l,options:n.map(function(e){return{value:e.value}})}))});case 3:t=e.sent,a=t.data,K("success","Poll was successfully created!",""),console.log(a),e.next=13;break;case 9:e.prev=9,e.t0=e.catch(0),console.log(e.t0.message),K("error","Bad request 500",e.t0.message);case 13:case"end":return e.stop()}},e,this,[[0,9]])})),style:{margin:"20px 0"}},"Save poll!"))}}]),t}(a.Component);function X(){var e=Object(k.a)(["\n  mutation CreatePoll($createPollInput: CreatePollInput!) {\n    createPoll(createPollInput: $createPollInput) {\n      id\n      options {\n        id\n      }\n    }\n  }\n"]);return X=function(){return e},e}var ee=P()(X()),te=function(e){function t(){return Object(E.a)(this,t),Object(O.a)(this,Object(j.a)(t).apply(this,arguments))}return Object(w.a)(t,e),Object(y.a)(t,[{key:"render",value:function(){return r.a.createElement(d.Mutation,{mutation:ee},function(e){return r.a.createElement(Z,{onSave:e})})}}]),t}(a.Component);function ne(){var e=Object(k.a)(["\n  query getPoll($id: ID!) {\n    poll(id: $id) {\n      id\n      answer\n      published\n      question\n      options {\n        id\n        value\n      }\n    }\n  }\n"]);return ne=function(){return e},e}function ae(){var e=Object(k.a)(["\n  mutation UpdatePoll($updatePollInput: UpdatePollInput!) {\n    updatePoll(updatePollInput: $updatePollInput) {\n      id\n    }\n  }\n"]);return ae=function(){return e},e}var re=P()(ae()),oe=P()(ne()),le=function(e){function t(){return Object(E.a)(this,t),Object(O.a)(this,Object(j.a)(t).apply(this,arguments))}return Object(w.a)(t,e),Object(y.a)(t,[{key:"render",value:function(){var e=this;return r.a.createElement(d.Query,{query:oe,variables:{id:this.props.match.params.id},pollInterval:1500},function(t){var n=t.loading,a=t.error,o=t.data;return n?"Loading...":a?"Error! ".concat(a.message):o.poll.published?"Poll is published!":r.a.createElement(d.Mutation,{mutation:re},function(t,n){n.loading,n.error;return r.a.createElement(Z,{isUpdate:!0,id:e.props.match.params.id,published:o.poll.published,order:o.poll.options.map(function(e){return e.id}),question:o.poll.question,options:Object(M.a)(o.poll.options),onSave:t})})})}}]),t}(a.Component),ie=n(503),ce=n(504),ue=n(515),se=n(528);function pe(){var e=Object(k.a)(["\n  mutation Publish($id: String!) {\n    publishPoll(id: $id)\n  }\n"]);return pe=function(){return e},e}function de(){var e=Object(k.a)(["\n  {\n    user {\n      id\n      polls {\n        id\n        answer\n        question\n        published\n      }\n      groups {\n        id\n        name\n        polls {\n          id\n          answer\n          question\n          published\n        }\n      }\n    }\n  }\n"]);return de=function(){return e},e}var me=P()(de()),he=P()(pe()),fe=function(e){function t(){return Object(E.a)(this,t),Object(O.a)(this,Object(j.a)(t).apply(this,arguments))}return Object(w.a)(t,e),Object(y.a)(t,[{key:"render",value:function(){var e=this;return r.a.createElement(d.Query,{query:me,pollInterval:1500},function(t){var n=t.loading,o=t.error,l=t.data;return n?"Loading...":o?"Error! ".concat(o.message):r.a.createElement(a.Fragment,null,l.user&&l.user.groups.map(function(t){return t.polls.length>0&&r.a.createElement(r.a.Fragment,null,r.a.createElement("h2",null,t.name),r.a.createElement(ie.a,{gutter:16},t.polls.map(function(n){return r.a.createElement(ce.a,{key:n.id,lg:8,md:12},r.a.createElement(ue.a,{style:{marginBottom:"20px"},actions:[r.a.createElement(J.a,{content:"Edit poll",trigger:"hover"},r.a.createElement(B.a,{disabled:n.published,icon:"edit",onClick:function(){return e.props.history.push("/admin/poll/".concat(n.id))}})),r.a.createElement(J.a,{content:"Go to poll page",trigger:"hover"},r.a.createElement(B.a,{icon:"eye",onClick:function(){return e.props.history.push("/group/".concat(t.id))}})),r.a.createElement(J.a,{content:"Publish poll",trigger:"hover"},r.a.createElement(d.Mutation,{mutation:he},function(e,t){var a=t.loading;t.error;return r.a.createElement(W.a,{loading:a,disabled:n.published,defaultChecked:n.published,onChange:Object(A.a)(I.a.mark(function t(){return I.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,e({variables:{id:n.id}});case 3:K("success","Poll was successfully published!",""),t.next=10;break;case 6:t.prev=6,t.t0=t.catch(0),console.log(t.t0.message),K("error","Bad request 500",t.t0.message);case 10:case"end":return t.stop()}},t,this,[[0,6]])}))})}))]},r.a.createElement("h4",null,n.question)))})))}),r.a.createElement(ie.a,{type:"flex",gutter:16},l.user&&l.user.polls.map(function(t){return r.a.createElement(ce.a,{key:t.id,lg:8,md:12},r.a.createElement(ue.a,{style:{marginBottom:"20px"},actions:[r.a.createElement(J.a,{content:"Edit poll",trigger:"hover"},r.a.createElement(B.a,{disabled:t.published,icon:"edit",onClick:function(){return e.props.history.push("/admin/poll/".concat(t.id))}})),r.a.createElement(J.a,{content:"Go to poll page",trigger:"hover"},r.a.createElement(B.a,{icon:"eye",onClick:function(){return e.props.history.push("/poll/".concat(t.id))}})),r.a.createElement(J.a,{content:"Publish poll",trigger:"hover"},r.a.createElement(d.Mutation,{mutation:he},function(e,n){var a=n.loading;n.error;return r.a.createElement(W.a,{loading:a,disabled:t.published,defaultChecked:t.published,onChange:Object(A.a)(I.a.mark(function n(){return I.a.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,n.next=3,e({variables:{id:t.id}});case 3:K("success","Poll was successfully published!",""),n.next=10;break;case 6:n.prev=6,n.t0=n.catch(0),console.log(n.t0.message),K("error","Bad request 500",n.t0.message);case 10:case"end":return n.stop()}},n,this,[[0,6]])}))})}))]},r.a.createElement("h4",null,t.question)))})))})}}]),t}(a.Component),ge=Object(se.a)(fe),ve=function(e){var t=e.match;return r.a.createElement(a.Fragment,null,r.a.createElement(c.a,null,r.a.createElement(u.a,{exact:!0,path:"".concat(t.path,"/all"),component:ge}),r.a.createElement(u.a,{exact:!0,path:"".concat(t.path,"/new"),component:te}),r.a.createElement(u.a,{path:"".concat(t.path,"/:id"),component:le})))},be=function(){return r.a.createElement("p",null,"Settings page")},Ee=n(518),ye=n(517),Oe=n(527);function je(){var e=Object(k.a)(["\n  mutation RemovePollFromGroup($removePollInput: RemovePollInput!) {\n    removePollFromGroup(removePollInput: $removePollInput)\n  }\n"]);return je=function(){return e},e}function we(){var e=Object(k.a)(["\n  mutation AddPollToGroup($addPollInput: AddPollInput!) {\n    addPollToGroup(addPollInput: $addPollInput)\n  }\n"]);return we=function(){return e},e}function ke(){var e=Object(k.a)(["\n  mutation Publish($id: String!) {\n    publishGroup(id: $id)\n  }\n"]);return ke=function(){return e},e}function xe(){var e=Object(k.a)(["\n  mutation CreateGroup($name: String!) {\n    createGroup(name: $name) {\n      id\n    }\n  }\n"]);return xe=function(){return e},e}function Pe(){var e=Object(k.a)(["\n  {\n    user {\n      id\n      groups {\n        id\n        name\n        published\n        polls {\n          question\n        }\n      }\n    }\n  }\n"]);return Pe=function(){return e},e}function Ce(){var e=Object(k.a)(["\n  query getGroup($id: ID!) {\n    group(id: $id) {\n      id\n      name\n      polls {\n        id\n        answer\n        question\n        options {\n          id\n          value\n          votes\n        }\n      }\n    }\n    user {\n      id\n      polls {\n        id\n        answer\n        question\n        published\n      }\n    }\n  }\n"]);return Ce=function(){return e},e}var Ie=P()(Ce()),qe=P()(Pe()),Se=P()(xe()),Ae=P()(ke()),Me=P()(we()),Ge=P()(je()),De=function(e){function t(){var e,n;Object(E.a)(this,t);for(var a=arguments.length,r=new Array(a),o=0;o<a;o++)r[o]=arguments[o];return(n=Object(O.a)(this,(e=Object(j.a)(t)).call.apply(e,[this].concat(r)))).state={name:"",visible:!1,groupId:""},n.showModal=function(e){n.setState({visible:!0,groupId:e})},n.handleOk=function(e){n.setState({visible:!1})},n.handleCancel=function(e){n.setState({visible:!1})},n}return Object(w.a)(t,e),Object(y.a)(t,[{key:"render",value:function(){var e=this,t=this.state.name;return console.log(this.state.groupId),r.a.createElement(r.a.Fragment,null,r.a.createElement($.a,{placeholder:"Group name",onChange:function(t){e.setState({name:t.target.value})}}),r.a.createElement(d.Mutation,{mutation:Se},function(e,n){var a=n.loading;n.error;return r.a.createElement(B.a,{loading:a,onClick:Object(A.a)(I.a.mark(function n(){var a,r;return I.a.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,n.next=3,e({variables:{name:t}});case 3:a=n.sent,r=a.data,K("success","Group was successfully created!",""),console.log(r),n.next=13;break;case 9:n.prev=9,n.t0=n.catch(0),console.log(n.t0.message),K("error","Bad request 500",n.t0.message);case 13:case"end":return n.stop()}},n,this,[[0,9]])})),style:{margin:"20px 0"}},"Create group!")}),r.a.createElement(ie.a,{gutter:16},r.a.createElement(d.Query,{query:qe},function(t){var n=t.loading,a=t.error,o=t.data;return n?"Loading...":a?"Error! ".concat(a.message):o.user&&o.user.groups.map(function(t){return r.a.createElement(ce.a,{key:t.id,lg:8,md:12},r.a.createElement(ue.a,{style:{marginBottom:"20px"},actions:[r.a.createElement(J.a,{content:"Publish group",trigger:"hover"},r.a.createElement(d.Mutation,{mutation:Ae},function(e,n){var a=n.loading;n.error;return r.a.createElement(W.a,{loading:a,disabled:t.published,defaultChecked:t.published,onChange:Object(A.a)(I.a.mark(function n(){return I.a.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,n.next=3,e({variables:{id:t.id}});case 3:K("success","Group was successfully published!",""),n.next=10;break;case 6:n.prev=6,n.t0=n.catch(0),console.log(n.t0.message),K("error","Bad request 500",n.t0.message);case 10:case"end":return n.stop()}},n,this,[[0,6]])}))})})),r.a.createElement(B.a,{disabled:t.published,type:"primary",onClick:function(){return e.showModal(t.id)}},"Add poll")]},r.a.createElement("h4",null,t.name)))})}),r.a.createElement(Ee.a,{title:"Add To Group",visible:this.state.visible,onOk:this.handleOk},r.a.createElement(d.Mutation,{mutation:Ge},function(t,n){n.loading,n.error;return r.a.createElement(d.Mutation,{mutation:Me},function(n,a){a.loading,a.error;return r.a.createElement(d.Query,{query:Ie,variables:{id:e.state.groupId}},function(e){var a=e.loading,o=e.error,l=e.data;return a?"Loading...":o?"Error! ".concat(o.message):l.user&&r.a.createElement(Le,{polls:l.user.polls.filter(function(e){return!1===e.published}),groupPolls:l.group.polls,groupId:l.group.id,addPollToGroup:n,delPollFromGroup:t})})})}))))}}]),t}(a.Component),Le=function(e){function t(){var e,n;Object(E.a)(this,t);for(var a=arguments.length,r=new Array(a),o=0;o<a;o++)r[o]=arguments[o];return(n=Object(O.a)(this,(e=Object(j.a)(t)).call.apply(e,[this].concat(r)))).state={selectedId:""},n}return Object(w.a)(t,e),Object(y.a)(t,[{key:"render",value:function(){var e=this;return console.log(this.state),r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{style:{display:"flex"}},r.a.createElement(ye.a,{placeholder:"Add poll to group",style:{width:"100%"},onChange:function(t){return e.setState({selectedId:t})}},this.props.polls.map(function(e){return r.a.createElement(ye.a.Option,{key:e.id,value:e.id},e.question," (",e.id,")")})),r.a.createElement(B.a,{onClick:Object(A.a)(I.a.mark(function t(){var n,a;return I.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,e.props.addPollToGroup({variables:{addPollInput:{groupId:e.props.groupId,pollId:e.state.selectedId}}});case 3:n=t.sent,a=n.data,K("success","Poll was successfully added to Group!",""),console.log(a),t.next=13;break;case 9:t.prev=9,t.t0=t.catch(0),console.log(t.t0.message),K("error","Bad request 500",t.t0.message);case 13:case"end":return t.stop()}},t,this,[[0,9]])}))},"Add")),this.props.groupPolls.map(function(t){return r.a.createElement(Oe.a,{closable:!0,key:t.id,onClose:Object(A.a)(I.a.mark(function n(){return I.a.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,n.next=3,e.props.delPollFromGroup({variables:{removePollInput:{groupId:e.props.groupId,pollId:t.id}}});case 3:K("success","Poll was successfully deleted from Group!",""),console.log(t),n.next=11;break;case 7:n.prev=7,n.t0=n.catch(0),console.log(n.t0.message),K("error","Bad request 500",n.t0.message);case 11:case"end":return n.stop()}},n,this,[[0,7]])}))},t.question)}))}}]),t}(a.Component),$e=De,Be=n(511),Fe=function(e){function t(){return Object(E.a)(this,t),Object(O.a)(this,Object(j.a)(t).apply(this,arguments))}return Object(w.a)(t,e),Object(y.a)(t,[{key:"parseTo",value:function(e){var t=document.createElement("a");return t.href=e,t}},{key:"isInternal",value:function(e){if(-1===e.indexOf("://"))return!0;var t=this.parseTo(e);return window.location.hostname===t.hostname}},{key:"render",value:function(){var e=this.props,t=e.to,n=e.children,a=Object(v.a)(e,["to","children"]);return this.isInternal(t)?r.a.createElement(Be.a,Object.assign({to:t},a),n):r.a.createElement("a",Object.assign({href:t,target:"_blank",rel:"noopener noreferrer"},a),n)}}]),t}(r.a.Component),Te=n(522),Ve=Object(se.a)(function(e){var t=e.data,n=e.location;return r.a.createElement(Te.a,{mode:"inline",selectedKeys:[n.pathname],style:{height:"100%"}},t.map(function(e){return r.a.createElement(Te.a.Item,{key:e.path},r.a.createElement(Fe,{to:e.path},e.icon&&r.a.createElement(L.a,{type:e.icon}),r.a.createElement("span",null,e.name)))}))}),ze=p.a.Content,Ye=p.a.Sider,He=[{id:0,name:"Add Poll",icon:"plus",path:"/admin/poll/new"},{id:1,name:"Groups",icon:"notification",path:"/admin/groups"},{id:2,name:"Polls",icon:"notification",path:"/admin/poll/all"},{id:3,name:"Settings",icon:"setting",path:"/admin/settings"}],Ne=function(e){function t(){return Object(E.a)(this,t),Object(O.a)(this,Object(j.a)(t).apply(this,arguments))}return Object(w.a)(t,e),Object(y.a)(t,[{key:"render",value:function(){var e=this.props.match;return r.a.createElement(a.Fragment,null,r.a.createElement(ze,{style:{padding:"0 50px"}},r.a.createElement(p.a,{style:{padding:"24px 0",background:"#fff"}},r.a.createElement(Ye,{width:200,style:{background:"#fff"}},r.a.createElement(Ve,{data:He})),r.a.createElement(ze,{style:{padding:"0 24px",minHeight:280}},r.a.createElement(c.a,null,r.a.createElement(u.a,{exact:!0,path:"".concat(e.path),render:function(){return r.a.createElement(s.a,{to:"".concat(e.path,"/poll/all")})}}),r.a.createElement(u.a,{path:"".concat(e.path,"/poll"),component:ve}),r.a.createElement(u.a,{path:"".concat(e.path,"/groups"),component:$e}),r.a.createElement(u.a,{path:"".concat(e.path,"/settings"),component:be}))))))}}]),t}(r.a.Component),Ue=function(){return r.a.createElement(ie.a,{type:"flex",style:{margin:"50px 0"},justify:"center"},r.a.createElement(ce.a,{xs:24,md:12},r.a.createElement(ue.a,{title:"Sign in"},r.a.createElement("p",null,"For using the system you should sign in."))))},Qe=function(e){function t(){var e,n;Object(E.a)(this,t);for(var a=arguments.length,r=new Array(a),o=0;o<a;o++)r[o]=arguments[o];return(n=Object(O.a)(this,(e=Object(j.a)(t)).call.apply(e,[this].concat(r)))).state={error:!1},n}return Object(w.a)(t,e),Object(y.a)(t,[{key:"componentWillMount",value:function(){try{var e=this.props.match.params.token;window.opener.postMessage({token:e},"http://localhost:3000"),window.opener.focus(),window.close()}catch(t){this.setState({error:!0})}}},{key:"render",value:function(){return r.a.createElement(ie.a,{type:"flex",style:{margin:"50px 0"},justify:"center"},r.a.createElement(ce.a,{xs:24,md:12},r.a.createElement(ue.a,{title:"Callback"},r.a.createElement("h1",null,this.state.error?"Error":"Success"))))}}]),t}(a.Component),Ke=function(e){var t=e.match;return r.a.createElement(a.Fragment,null,r.a.createElement(c.a,null,r.a.createElement(u.a,{exact:!0,path:"".concat(t.path),component:Ue}),r.a.createElement(u.a,{path:"".concat(t.path,"/:token"),component:Qe})))},_e=n(516),Re=n(485),Je=n(486),We=n(512),Ze=n(502),Xe=n(484),et=["#0088FE","#00C49F","#FFBB28","#FF8042"],tt=[{name:"Page A",value:2400},{name:"Page B",value:1398},{name:"Page C",value:9800},{name:"Page D",value:3908},{name:"Page E",value:4800},{name:"Page F",value:3800},{name:"Page G",value:4300}],nt=function(e){function t(){var e,n;Object(E.a)(this,t);for(var a=arguments.length,o=new Array(a),l=0;l<a;l++)o[l]=arguments[l];return(n=Object(O.a)(this,(e=Object(j.a)(t)).call.apply(e,[this].concat(o)))).state={data:n.props.data||tt},n.getPath=function(e,t,n,a){return"M".concat(e,",").concat(t+a,"\n            C").concat(e+n/3,",").concat(t+a," ").concat(e+n/2,",").concat(t+a/3," ").concat(e+n/2,", ").concat(t,"\n            C").concat(e+n/2,",").concat(t+a/3," ").concat(e+2*n/3,",").concat(t+a," ").concat(e+n,", ").concat(t+a,"\n            Z")},n.TriangleBar=function(e){var t=e.fill,a=e.x,o=e.y,l=e.width,i=e.height;return r.a.createElement("path",{d:n.getPath(a,o,l,i),stroke:"none",fill:t})},n}return Object(w.a)(t,e),Object(y.a)(t,[{key:"render",value:function(){var e=this.state.data;return r.a.createElement(_e.a,{width:600,height:300,data:e,margin:{top:20,right:30,left:20,bottom:5}},r.a.createElement(Re.a,{dataKey:"name"}),r.a.createElement(Je.a,null),r.a.createElement(We.a,{strokeDasharray:"3 3"}),r.a.createElement(Ze.a,{dataKey:"value",fill:"#8884d8",shape:this.TriangleBar,label:{position:"top"}},e.map(function(e,t){return r.a.createElement(Xe.a,{key:"cell-".concat(t),fill:et[t%20]})})))}}]),t}(a.Component);function at(){var e=Object(k.a)(["\n  .ant-radio-wrapper {\n    display: block;\n    height: 30px;\n  }\n"]);return at=function(){return e},e}function rt(){var e=Object(k.a)(["\n  mutation Vote($voteInput: VoteInput!) {\n    vote(voteInput: $voteInput)\n  }\n"]);return rt=function(){return e},e}function ot(){var e=Object(k.a)(["\n  query getPoll($id: ID!) {\n    poll(id: $id) {\n      id\n      answer\n      published\n      author {\n        profile {\n          name\n          avatar\n        }\n      }\n      question\n      options {\n        id\n        value\n        votes\n      }\n    }\n  }\n"]);return ot=function(){return e},e}var lt=D.a.Group,it=P()(ot()),ct=P()(rt()),ut=Object(F.b)(lt)(at()),st=function(e){function t(){var e,n;Object(E.a)(this,t);for(var a=arguments.length,r=new Array(a),o=0;o<a;o++)r[o]=arguments[o];return(n=Object(O.a)(this,(e=Object(j.a)(t)).call.apply(e,[this].concat(r)))).state={answerID:null,voted:!1},n.onAnswerChange=function(e){n.setState({answerID:e.target.value})},n}return Object(w.a)(t,e),Object(y.a)(t,[{key:"render",value:function(){var e=this,t=this.state,n=t.answerID,a=t.voted;return console.log(a),r.a.createElement(p.a,{style:{padding:"0 50px",background:"#fff"}},r.a.createElement(p.a.Content,{style:{padding:"24px 0",display:"flex",justifyContent:"center",alignItems:"center"}},r.a.createElement(d.Query,{query:it,variables:{id:this.props.match.params.id},pollInterval:1500},function(t){var a=t.loading,o=t.error,l=t.data;return a?"Loading...":o?"Error! ".concat(o.message):l.poll.published?r.a.createElement(ie.a,{style:{width:"100%"},gutter:16},r.a.createElement(ce.a,{lg:12,md:24},r.a.createElement("h1",null,l.poll.question),r.a.createElement("p",null,l.poll.author.profile.name)),r.a.createElement(ce.a,{lg:12,md:24},!l.poll.answer||e.state.answerID?r.a.createElement(ue.a,null,r.a.createElement(ut,{disabled:!!l.poll.answer,onChange:e.onAnswerChange,value:l.poll.answer||e.state.answerID},l.poll.options.map(function(e){return r.a.createElement(D.a,{key:e.id,value:e.id},e.value)})),r.a.createElement(d.Mutation,{mutation:ct},function(t,a){a.loading,a.error;return r.a.createElement(B.a,{disabled:!!l.poll.answer,onClick:Object(A.a)(I.a.mark(function a(){var r,o;return I.a.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.prev=0,a.next=3,t({variables:{voteInput:{optionId:n,pollId:e.props.match.params.id}}});case 3:r=a.sent,o=r.data,K("success","Voted successfully!",""),e.setState({voted:!0}),console.log(o),a.next=14;break;case 10:a.prev=10,a.t0=a.catch(0),console.log(a.t0.message),K("error","Bad request 500",a.t0.message);case 14:case"end":return a.stop()}},a,this,[[0,10]])}))},"Vote")})):r.a.createElement(nt,{data:l.poll.options.map(function(e){var t=e.votes;return{name:e.value,value:t}})}))):"Poll is not published :("})))}}]),t}(a.Component),pt=n(513);function dt(){var e=Object(k.a)(['\n  background: #f3f4f7;\n  padding: 24px;\n  .slick-slide {\n    display: "flex",\n    justifyContent: "center",\n    alignItems: "center"\n    overflow: hidden;\n  }\n']);return dt=function(){return e},e}function mt(){var e=Object(k.a)(["\n  .ant-radio-wrapper {\n    display: block;\n    height: 30px;\n  }\n"]);return mt=function(){return e},e}function ht(){var e=Object(k.a)(["\n  mutation Vote($voteInput: VoteInput!) {\n    vote(voteInput: $voteInput)\n  }\n"]);return ht=function(){return e},e}function ft(){var e=Object(k.a)(["\n  query getGroup($id: ID!) {\n    group(id: $id) {\n      name\n      polls {\n        id\n        answer\n\n        question\n        options {\n          id\n          value\n          votes\n        }\n      }\n    }\n  }\n"]);return ft=function(){return e},e}var gt=D.a.Group,vt=P()(ft()),bt=P()(ht()),Et=Object(F.b)(gt)(mt()),yt=Object(F.b)(pt.a)(dt()),Ot=function(e){function t(){var e,n;Object(E.a)(this,t);for(var a=arguments.length,r=new Array(a),o=0;o<a;o++)r[o]=arguments[o];return(n=Object(O.a)(this,(e=Object(j.a)(t)).call.apply(e,[this].concat(r)))).state={answerID:null,voted:!1},n.onAnswerChange=function(e){n.setState({answerID:e.target.value})},n}return Object(w.a)(t,e),Object(y.a)(t,[{key:"render",value:function(){var e=this,t=this.state.answerID;return r.a.createElement(ie.a,{gutter:16},r.a.createElement(ce.a,{lg:12,md:24},r.a.createElement("h1",null,this.props.poll.question)),r.a.createElement(ce.a,{lg:12,md:24},!this.props.poll.answer||this.state.answerID?r.a.createElement(ue.a,null,r.a.createElement(Et,{disabled:!!this.props.poll.answer,onChange:this.onAnswerChange,value:this.props.poll.answer||this.state.answerID},this.props.poll.options.map(function(e){return r.a.createElement(D.a,{key:e.id,value:e.id},e.value)})),r.a.createElement(d.Mutation,{mutation:bt},function(n,a){a.loading,a.error;return r.a.createElement(B.a,{disabled:!!e.props.poll.answer,onClick:Object(A.a)(I.a.mark(function a(){var r,o;return I.a.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.prev=0,a.next=3,n({variables:{voteInput:{optionId:t,pollId:e.props.poll.id}}});case 3:r=a.sent,o=r.data,K("success","Voted successfully!",""),e.setState({voted:!0}),console.log(o),a.next=14;break;case 10:a.prev=10,a.t0=a.catch(0),console.log(a.t0.message),K("error","Bad request 500",a.t0.message);case 14:case"end":return a.stop()}},a,this,[[0,10]])}))},"Vote")})):r.a.createElement(nt,{data:this.props.poll.options.map(function(e){var t=e.votes;return{name:e.value,value:t}})})))}}]),t}(a.Component),jt=function(e){function t(){return Object(E.a)(this,t),Object(O.a)(this,Object(j.a)(t).apply(this,arguments))}return Object(w.a)(t,e),Object(y.a)(t,[{key:"render",value:function(){return r.a.createElement(p.a,{style:{padding:"0 50px",background:"#fff"}},r.a.createElement(p.a.Content,{style:{padding:"24px 0"}},r.a.createElement(d.Query,{query:vt,variables:{id:this.props.match.params.id},pollInterval:1500},function(e){var t=e.loading,n=e.error,a=e.data;return t?"Loading...":n?"Error! ".concat(n.message):r.a.createElement(yt,null,a.group.polls.map(function(e){return r.a.createElement(Ot,{poll:e})}))})))}}]),t}(a.Component),wt=function(){return r.a.createElement("p",null,"404 Not found")},kt=n(514);function xt(){var e=Object(k.a)(["\n  display: flex;\n  flex-direction: column;\n  justify-items: between;\n  width: 150px;\n  button {\n    margin: 5px 0;\n  }\n"]);return xt=function(){return e},e}function Pt(){var e=Object(k.a)(["\n  color: rgba(255, 255, 255, 0.6);\n  line-height: 1;\n  font-size: 12px;\n"]);return Pt=function(){return e},e}function Ct(){var e=Object(k.a)(["\n  padding-bottom: 10px;\n  padding-right: 15px;\n  line-height: 1;\n  color: white;\n  font-size: 16px;\n"]);return Ct=function(){return e},e}function It(){var e=Object(k.a)(["\n  display: flex;\n  justify-content: flex-end;\n  align-items: center;\n  height: 100%;\n"]);return It=function(){return e},e}var qt=F.b.div(It()),St=F.b.div(Ct()),At=F.b.div(Pt()),Mt=F.b.div(xt()),Gt=function(e){var t=e.avatar,n=e.fullName,a=e.userName,o=e.onLogout;e.onMyPolls;return r.a.createElement(qt,null,r.a.createElement(J.a,{content:r.a.createElement(Mt,null,r.a.createElement(B.a,{onClick:o},"Logout")),trigger:"click"},r.a.createElement(St,null,n),r.a.createElement(At,null,a)),r.a.createElement(kt.a,{size:36,src:t}))},Dt=Object(se.a)(function(e){var t=e.data,n=e.user,a=void 0!==n&&n,o=e.location,l=e.onLoginClick,i=e.onLogoutClick;return r.a.createElement(Te.a,{theme:"dark",mode:"horizontal",selectedKeys:[o.pathname],style:{lineHeight:"64px",display:"flex"}},t.map(function(e){return r.a.createElement(Te.a.Item,{key:e.path},r.a.createElement(Fe,{to:e.path},e.name))}),r.a.createElement(Te.a.Item,{style:{marginLeft:"auto"}},!a&&r.a.createElement(B.a,{onClick:l,size:"large"},r.a.createElement(L.a,{type:"github"}),"Sign in with Github"),a&&r.a.createElement(Gt,{avatar:a.avatar,fullName:a.name,userName:a.github_username,onLogout:i})))});function Lt(){var e=Object(k.a)(["\n  {\n    user {\n      id\n      email\n      profile {\n        name\n        github_username\n        avatar\n      }\n    }\n  }\n"]);return Lt=function(){return e},e}var $t=[{id:0,name:"About",path:"/about"},{id:1,name:"Github",path:"https://github.com"}],Bt=P()(Lt()),Ft=function(e){function t(e){var n;return Object(E.a)(this,t),(n=Object(O.a)(this,Object(j.a)(t).call(this,e))).listener=function(e){var t=e.origin,a=e.data;if("http://localhost:3000"===t&&a.token){h.write(a.token),n.setState({isAuthenticated:!0});var r=sessionStorage.getItem("auth:redirect");r?n.props.history.push(r):n.props.history.push("/admin")}},n.openPopup=function(e){var t=window.screen.width/2-250,n=window.screen.height/2-300;return window.open("https://poll-app-server.herokuapp.com"+e,"","toolbar=no, location=no, directories=no, status=no, menubar=no, scrollbars=no, resizable=no, copyhistory=no, width=".concat(500,", height=").concat(600,", top=").concat(n,", left=").concat(t))},n.state={isAuthenticated:!!h.read()},n}return Object(w.a)(t,e),Object(y.a)(t,[{key:"componentDidMount",value:function(){window.addEventListener("message",this.listener)}},{key:"render",value:function(){var e=this,t=this.state.isAuthenticated;return r.a.createElement(p.a.Header,null,t?r.a.createElement(d.Query,{query:Bt},function(t){var n=t.loading,o=t.error,l=t.data;return n?"Loading...":o?(e.setState({isAuthenticated:!1}),h.delete(),r.a.createElement(s.a,{to:"/signin"})):r.a.createElement(a.Fragment,null,l.user&&r.a.createElement(Dt,{onLoginClick:function(){return e.openPopup("/auth/github")},onLogoutClick:function(){e.setState({isAuthenticated:!1}),h.delete(),e.props.history.push("/signin")},data:$t,user:l.user.profile}))}):r.a.createElement(Dt,{onLoginClick:function(){return e.openPopup("/auth/github")},data:$t}))}}]),t}(a.Component),Tt=Object(se.a)(Ft),Vt=function(){return r.a.createElement(p.a.Footer,{style:{textAlign:"center",marginTop:"auto"}},"\xa9 2018 BSTU")},zt=function(e){e.match;return r.a.createElement(i.a,null,r.a.createElement(d.ApolloProvider,{client:g},r.a.createElement(p.a,{style:{minHeight:"100vh"}},r.a.createElement(Tt,null),r.a.createElement(c.a,null,r.a.createElement(b,{path:"/admin",component:Ne}),r.a.createElement(u.a,{exact:!0,path:"/",render:function(){return r.a.createElement(s.a,{to:"/admin"})}}),r.a.createElement(u.a,{path:"/signin",component:Ke}),r.a.createElement(b,{path:"/poll/:id",component:st}),r.a.createElement(b,{path:"/group/:id",component:jt}),r.a.createElement(u.a,{path:"*",component:wt})),r.a.createElement(Vt,null))))};n(498);function Yt(){var e=Object(k.a)(["\n  html,\n  body {\n    height: 100%;\n    width: 100%;\n  }\n  body {\n    font-family: 'Helvetica Neue', Helvetica, Arial, sans-serif;\n  }\n  body.fontLoaded {\n    font-family: 'Basis Grotesque Pro', 'Helvetica Neue', Helvetica, Arial, sans-serif;\n  }\n  /* p,\n  label {\n    font-family: 'Basis Grotesque Pro', Georgia, Times, 'Times New Roman', serif;\n    font-weight: 500;\n    line-height: 1.5em;\n  } */\n"]);return Yt=function(){return e},e}var Ht=Object(F.a)(Yt());l.a.render(r.a.createElement(r.a.Fragment,null,r.a.createElement(zt,null),r.a.createElement(Ht,null)),document.getElementById("root"))}},[[273,2,1]]]);
//# sourceMappingURL=main.19319fcd.chunk.js.map